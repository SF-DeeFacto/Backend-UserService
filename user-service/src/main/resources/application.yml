# ========================================
# User Service 애플리케이션 공통 설정 파일
# ========================================
# 
# 이 파일은 User Service의 공통 설정만 정의합니다.
# 환경별 설정은 application-dev.yml, application-prod.yml에서 관리합니다.
# 
# 환경 변수 사용:
# - ${환경변수명}: 기본값 없이 환경 변수 사용
# - ${환경변수명:기본값}: 환경 변수가 없을 때 기본값 사용

# Spring Boot 설정
spring:
  # 애플리케이션 이름 (서비스 디스커버리에서 사용)
  application:
    name: ${SPRING_APPLICATION_NAME:user-service}

  kafka:
    listener:
      ack-mode: manual_immediate
    consumer:
      group-id: ${spring.application.name}
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.springframework.kafka.support.serializer.JsonDeserializer
      enable-auto-commit: false
      auto-offset-reset: latest
      max-poll-records: 10
      properties:
        spring.json.trusted.packages: "*"
        spring.json.use.type.headers: false
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.springframework.kafka.support.serializer.JsonSerializer
      properties:
        spring.json.add.type.headers: false


  # 활성 프로필 설정 (dev, prod 중 선택)
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:dev}
  
  # Flyway 데이터베이스 마이그레이션 설정
  flyway:
    # Flyway 활성화 여부 (환경 변수에서 가져오거나 기본값 true 사용)
    enabled: ${FLYWAY_ENABLED:true}
    # 마이그레이션 SQL 파일 위치
    locations: classpath:db/migration

# ========================================
# .env 파일 자동 로드 설정
# ========================================
# Spring Boot에서 .env 파일을 자동으로 로드하도록 설정
# 이 설정은 spring-dotenv 라이브러리가 필요합니다
  config:
    import: optional:file:.env[.properties]

